# OpenCV Tips

## Read image directly in grayscale

```python
img = cv2.imread('image.jpg', cv2.IMREAD_GRAYSCALE)
```

## Reading base64 image

### Use directly without saving as png

```python
import cv2
import base64
import numpy as np
import matplotlib.pyplot as plt
# raw data with base64 encoding
image = "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"
decoded_data = base64.b64decode(image.encode('utf-8'))
np_data = np.frombuffer(decoded_data, np.uint8)
img_bgr = cv2.imdecode(np_data, cv2.IMREAD_UNCHANGED)
img = cv2.cvtColor(img_bgr, cv2.COLOR_BGR2RGB)
plt.imshow(img)
```

### Convert and save as png

```python
import base64
base64_img_bytes = formula.input_image.base64_img.encode('utf-8')
with open("img.png", "wb") as f:
    f.write(base64.decodebytes(base64_img_bytes))
```
